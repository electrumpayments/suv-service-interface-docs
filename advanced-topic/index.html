<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Advanced Topics - Single Use Voucher Service Interface</title>
    <meta name="generator" content="Hugo 0.29" />

    
    <link rel="canonical" href="https://electrumpayments.github.io/suv-service-interface-docs/advanced-topic/">
    

    <meta property="og:url" content="https://electrumpayments.github.io/suv-service-interface-docs/advanced-topic/">
    <meta property="og:title" content="Single Use Voucher Service Interface">
    <meta property="og:image" content="https://electrumpayments.github.io/suv-service-interface-docs/images/logo-square.png">
    <meta name="apple-mobile-web-app-title" content="Single Use Voucher Service Interface">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://electrumpayments.github.io/suv-service-interface-docs/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://electrumpayments.github.io/suv-service-interface-docs/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://electrumpayments.github.io/suv-service-interface-docs/fonts/icon.eot');
        src: url('https://electrumpayments.github.io/suv-service-interface-docs/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://electrumpayments.github.io/suv-service-interface-docs/fonts/icon.woff')
               format('woff'),
             url('https://electrumpayments.github.io/suv-service-interface-docs/fonts/icon.ttf')
               format('truetype'),
             url('https://electrumpayments.github.io/suv-service-interface-docs/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://electrumpayments.github.io/suv-service-interface-docs/stylesheets/application.css">
    <link rel="stylesheet" href="https://electrumpayments.github.io/suv-service-interface-docs/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://electrumpayments.github.io/suv-service-interface-docs/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://electrumpayments.github.io/suv-service-interface-docs/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://electrumpayments.github.io/suv-service-interface-docs/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-cyan palette-accent-orange">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Advanced Topics
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/electrumpayments" title="@electrumpayments on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/electrumpayments/suv-service-interface" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://electrumpayments.github.io/suv-service-interface-docs/images/logo-square.png">
        </div>
      
      <div class="name">
        <strong>Single Use Voucher Service Interface </strong>
        
          <br>
          electrumpayments/suv-service-interface
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/electrumpayments/suv-service-interface/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/electrumpayments/suv-service-interface/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Getting Started" href="https://electrumpayments.github.io/suv-service-interface-docs/getting-started/">
	
	Getting Started
</a>



  
</li>



<li>
  
    



<a  title="Overview" href="https://electrumpayments.github.io/suv-service-interface-docs/overview/">
	
	Overview
</a>



  
</li>



<li>
  
    



<a  title="Protocol Basics" href="https://electrumpayments.github.io/suv-service-interface-docs/protocolbasics/">
	
	Protocol Basics
</a>



  
</li>



<li>
  
    



<a  title="Message Flows" href="https://electrumpayments.github.io/suv-service-interface-docs/messageflows/">
	
	Message Flows
</a>



  
</li>



<li>
  
    



<a  title="Advanced Topics" href="https://electrumpayments.github.io/suv-service-interface-docs/advanced-topic/">
	
	Advanced Topics
</a>



  
</li>



<li>
  
    <span class="section">Specification</span>
    <ul>
      
        
        



<a  title="Introduction" href="https://electrumpayments.github.io/suv-service-interface-docs/specification/introduction/">
	
	Introduction
</a>



      
        
        



<a  title="Operations" href="https://electrumpayments.github.io/suv-service-interface-docs/specification/operations/">
	
	Operations
</a>



      
        
        



<a  title="Definitions" href="https://electrumpayments.github.io/suv-service-interface-docs/specification/definitions/">
	
	Definitions
</a>



      
        
        



<a  title="Swagger" href="https://electrumpayments.github.io/suv-service-interface-docs/specification/swagger/">
	
	Swagger
</a>



      
        
        



<a  title="Release Notes" href="https://electrumpayments.github.io/suv-service-interface-docs/specification/release-notes/">
	
	Release Notes
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Advanced Topics </h1>

			

<h2 id="request-id-construction-and-handling">Request ID Construction And Handling</h2>

<p>Generation of UUIDs for voucher provision request messages is an important step in the request process. The id field of a VoucherRequest is the single field guaranteed to always allow an entity to locate all messages pertaining to a voucher request (as well as subsequent related messages). It is therefore important that the ID value generated by a client is unique for that client. If you are developing a client implementation, please take note to generate IDs as random UUID&rsquo;s, as defined for a variant 4 UUID by <a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a>. These request identifiers must uniquely identify a request within your own client implementation. If possible, the client should check that the UUID generated for a message has not been previously generated. If the UUID has been used previously then the client should generate a new UUID. This process should be repeated as necessary until a unique UUID has been generated.</p>

<p>This specification acknowledges that since clients produce random UUIDs, there is a possibility that a client might repeat an ID for two independent messages of the same type if the client is unable to perform the above checks. Furthermore, independent clients may submit two distinct requests with the same UUIDs. Therefore, if you are developing a server implementation, take care to verify that a request to create a resource does not contain an ID that already exists in the system. All such requests must be declined with a status code of 400 and an <a href="https://electrumpayments.github.io/suv-service-interface-docs/specification/definitions/#errordetail">ErrorType</a> of DUPLICATE_RECORD.</p>

<p>Finally, if a client receives an HTTP 400 response with an <a href="https://electrumpayments.github.io/suv-service-interface-docs/specification/definitions/#errordetail">ErrorType</a> of DUPLICATE_RECORD, it is suggested that the client simply generate a new UUID for the request and resubmit the request with the new UUID.</p>

<h2 id="request-matching">Request Matching</h2>

<p>The manner in which messages created after an initial voucher provision request are associated with the original voucher provision request is dependent on the type of message. The Single Use Voucher Service Interface provides numerous ways to ensure any message other than a request message can be matched to the original request message.</p>

<h3 id="uuid-matching">UUID Matching</h3>

<p>The Single Use Voucher Service Interface matches related messages primarily through the use of UUIDs. UUIDs are intended to uniquely identify a message across all client and server implementations of the Single Use Voucher Service Interface. Within any implementation of the Single Use Voucher Service Interface a given request UUID must be unique. This enables certainty that any subsequent response or advice message with the same request UUID does indeed refer to the prior request with that UUID.</p>

<h3 id="third-party-identifiers">Third Party Identifiers</h3>

<p>The Single Use Voucher Service Interface recognises that while UUIDs uniquely identify a message within an implementation, an entity may choose to use a different value as a transaction identifier which is unsuitable as a UUID. Furthermore, a transaction may be processed by entities not implementing the Single Use Voucher Service Interface and the identifiers assigned by these entities may need to be persisted in messages. Thus the Single Use Voucher Service Interface defines a <a href="https://electrumpayments.github.io/suv-service-interface-docs/specification/definitions/#thirdpartyidentifier">ThirdPartyIdentifer</a> model which allows an entity to associate a value of its own choosing with the transaction. The collection of such values is persisted in messages pertaining to a single transaction.</p>

<p>This collection of ThirdPartyIdentifiers is intended to be used by entities to match any message containing a given identifier to any other message containing the same identifier within the entity&rsquo;s own system. It is important to note that the sending of ThirdPartyIdentifiers does not supersede the use of UUIDs to match messages.</p>

<h3 id="vouchers">Vouchers</h3>

<p>Matching of messages using vouchers specifically pertains to <a href="https://electrumpayments.github.io/suv-service-interface-docs/specification/operations/#voucherConfirmation">voucher confirmations</a>. In such situations a confirmation of a voucher will directly indicate the voucher to be confirmed. This is possible since a voucher cannot be confirmed unless the originator is aware of the voucher to be confirmed. It is important to note that the use of vouchers for matching does not preclude the use of UUIDs or ThirdPartyIdentifiers for matching of messages.</p>

<h2 id="reversals-vs-refunds">Reversals vs Refunds</h2>

<p>Reversal messages pertain specifically to voucher provision requests for which the client did not receive a final response or was not able to complete the processing of the response. Thus the client has direct knowledge of the voucher provision request to be reversed but not of the possible voucher which may have been provisioned. The client must include the original request in the reversal message. A reversal takes place immediately after a failed provision.</p>

<p>Refunds may take place at any time after a voucher has been provisioned and confirmed. At the time of a refund the originator may not have knowledge of the original identifiers used in the voucher provision or confirmation operations. Refunds are beyond the scope of the Single Use Voucher Service Interface.</p>

<h2 id="store-and-forward">Store-and-forward</h2>

<p>To ensure that loss of transactional data is minimised, the Single Use Voucher Service Interface requires clients to store advice messages in persistent storage and keep them queued until a final status type is received. A final response is one of either the <em>successful</em> or <em>failed</em> status types. If the single use voucher service is not responding, or responding with an <em>unknown</em> status type, advice messages shall be queued and the message at the head of the queue repeated regularly until a final status type is received. For high throughput systems it shall be acceptable to send several messages in parallel. Client and server systems in high throughput environments should therefore be prepared to process advice and advice response messages in any order.</p>

<p>The above applies to the following operations:</p>

<ul>
<li>Confirmation</li>
<li>Reversal</li>
</ul>


			<aside class="copyright" role="note">
				
				&copy; 2018 Released under the Apache 2.0 license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				<nav class="pagination" aria-label="Footer">
  <div >
    <img src="https://electrumpayments.github.io/suv-service-interface-docs/images/logo-small-white.png" align="right"/>
  </div>
</nav>
			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/electrumpayments.github.io\/suv-service-interface-docs\/';
      var repo_id  = 'electrumpayments\/suv-service-interface';
    
    </script>

    <script src="https://electrumpayments.github.io/suv-service-interface-docs/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

